<body>
<div class="thread-container">
    <button class="btn btn-default inbox-back"><span class="glyphicon glyphicon-chevron-left"></span> Back</button>

    <h4 class="thread-book-title">{{ thread.listing.book.title }}</h4>
    <h5 class="thread-book-asking">Asking price: <span>${{ thread.listing.asking_price }}</span></h5>

    <table class="message-thread-table">
    {% for message in thread.chron_messages %}
        <tbody>
            <tr>
                <td class="message-sender">
                    {% if message.created_by == user %}
                        You:
                    {% else %}
                        {{ message.created_by.username }}:
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>{{ message.text }}</td>
                <td class="message-price">${{ message.price }}</td>
            </tr>
            <tr>
                <td class="message-date">{{ message.date_created|date:"n/j/y g:i A" }}</td>
            </tr>
        </tbody>
    {% endfor %}
    </table>

    <form class="message-form" method="post" action="{% url "thread" thread.pk %}">
        {% csrf_token %}
        <h4>Submit a Counteroffer/Message</h4>
        {% for field in form %}
            <div class="form-group">
                {{ field.label_tag }}
                {{ field.errors }}
                {{ field }}
            </div>
        {% endfor %}

        <button type="submit" class="btn btn-success">Submit</button>
        {% if thread.listing.is_available %}
            <button class="btn btn-default mark-pend-btn" type="button">Mark as Pending</button>
        {% elif thread.listing.is_pending %}
            <button class="btn btn-default mark-sold-btn">Mark as Sold</button>
        {% endif %}
    </form>
</div>
</body>